<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" data-next-head=""/><link rel="manifest" href="/favicon/site.webmanifest" data-next-head=""/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000" data-next-head=""/><link rel="shortcut icon" href="/favicon/favicon.ico" data-next-head=""/><meta name="msapplication-TileColor" content="#000000" data-next-head=""/><meta name="msapplication-config" content="/favicon/browserconfig.xml" data-next-head=""/><meta name="theme-color" content="#000" data-next-head=""/><link rel="alternate" type="application/rss+xml" href="/feed.xml" data-next-head=""/><meta property="og:image" content="/ogp-image-default.png" data-next-head=""/><meta name="twitter:card" content="summary" data-next-head=""/><meta name="twitter:site" content="@Nagatani" data-next-head=""/><title data-next-head=""></title><meta name="description" content="Memorandum - メモにメモ以上の価値を求めてはいけない | 以前のサイトで書いていたChromeのブックマークレットの記事を再掲します" data-next-head=""/><meta property="og:image" content="/ogp-image-default.png" data-next-head=""/><meta property="og:title" content="いつも使ってるブックマークレット(過去記事の再掲) | Memorandum" data-next-head=""/><meta property="og:description" content="Memorandum - メモにメモ以上の価値を求めてはいけない | 以前のサイトで書いていたChromeのブックマークレットの記事を再掲します" data-next-head=""/><meta name="twitter:image" content="/twcard.jpg" data-next-head=""/><meta name="twitter:title" content="いつも使ってるブックマークレット(過去記事の再掲) | Memorandum" data-next-head=""/><meta name="twitter:description" content="Memorandum - メモにメモ以上の価値を求めてはいけない | 以前のサイトで書いていたChromeのブックマークレットの記事を再掲します" data-next-head=""/><link rel="preload" href="/_next/static/css/07eccf6786972008.css" as="style"/><link rel="preload" href="/_next/static/css/3cc16716778c58b9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/07eccf6786972008.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/3cc16716778c58b9.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-47bc125f1e660795.js" defer=""></script><script src="/_next/static/chunks/framework-2f335d22a7318891.js" defer=""></script><script src="/_next/static/chunks/main-a0b91abc0375fa06.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e386d372de7aca44.js" defer=""></script><script src="/_next/static/chunks/982-48594ef60d0edcd3.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-aed0b18e9f0e97b6.js" defer=""></script><script src="/_next/static/KkecMBZn0eRxO-9hSKnjv/_buildManifest.js" defer=""></script><script src="/_next/static/KkecMBZn0eRxO-9hSKnjv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout"><div class="border-b bg-neutral-50 border-neutral-200"><div class="container"><div class=""></div></div></div><main><div class="container"><section class="post-header"><h2><a class="hover:underline" href="/">Memorandum</a></h2></section><article class="znc"><h1 class="postTitle">いつも使ってるブックマークレット(過去記事の再掲)</h1><div class="date"><time dateTime="2022-06-09T22:13:02+09:00">2022/06/09 13:13</time></div><div class="postBody"><div class="markdown-styles_markdown__HwUWZ"><h2 id="%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88" data-line="1" class="code-line"><a class="header-anchor-link" href="#%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88" aria-hidden="true"></a> 見ているサイトを共有するためのブックマークレット</h2>
<p data-line="3" class="code-line"><em><strong>Chromeでしか動作確認してません。</strong></em></p>
<p data-line="5" class="code-line">ブックマークレットでできることはできる限りやるようにすると、余計なChrome拡張機能を追加しなくて済むのでおすすめ。<br />
ブックマークレットの作り方をわざわざ説明するのめんどいので使いたいひとは調べよう。</p>
<h3 id="%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88" data-line="8" class="code-line"><a class="header-anchor-link" href="#%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88" aria-hidden="true"></a> 今見ているWebサイトをTwitterで共有するブックマークレット</h3>
<p data-line="10" class="code-line">TwitterへのWebページ共有はコレを使ってる。「見てる」ってのは、「見てる」のであって読んではいないんですよ。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="12"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">open</span><span class="token punctuation">(</span><span class="token string">"https://twitter.com/intent/tweet?text="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">"見てる / "</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&amp;url="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">location</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p data-line="16" class="code-line">1行で書いたやつを整形したコード:</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="18"><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">open</span><span class="token punctuation">(</span>
    <span class="token string">"https://twitter.com/intent/tweet?text="</span>
    <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">"見てる / "</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">)</span>
    <span class="token operator">+</span> <span class="token string">"&amp;url="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">location</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" data-line="29" class="code-line"><a class="header-anchor-link" href="#markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" aria-hidden="true"></a> Markdownで見てるサイトのURLを取得する</h3>
<p data-line="30" class="code-line">資料作成はほぼMarkdownで書いてるので、これは必須。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="32"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">prompt</span><span class="token punctuation">(</span><span class="token string">"Link Created! - Markdown"</span><span class="token punctuation">,</span> <span class="token string">'['</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">+</span> <span class="token string">']('</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">location</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)" data-line="36" class="code-line"><a class="header-anchor-link" href="#html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)" aria-hidden="true"></a> HTMLのAタグで見てるサイトのURLを取得する(target="_blank"付き)</h3>
<p data-line="37" class="code-line">資料書いてる時にどうしても<code>target="\_blank"</code>を使いたい時に使う。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="39"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">prompt</span><span class="token punctuation">(</span><span class="token string">"Link Created! - html"</span><span class="token punctuation">,</span> <span class="token string">'&lt;a href="'</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">location</span> <span class="token operator">+</span> <span class="token string">'" target="_blank"&gt;'</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">+</span> <span class="token string">"&lt;/a&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4" data-line="43" class="code-line"><a class="header-anchor-link" href="#amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4" aria-hidden="true"></a> Amazonの商品ページのURLをきれいにするやつ</h3>
<p data-line="45" class="code-line">Amazonの商品ページのURL、遷移元なんかの余計なクエリ文字列がくっついてくることがほとんどで、それを共有するのは気が引ける。<br />
そんな時はこれ。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="48"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel="canonical"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">amazon<span class="token char-set class-name">.</span>co<span class="token char-set class-name">.</span>jp<span class="token escape">\/</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token escape">\/</span>dp</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'amazon.co.jp/dp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p data-line="52" class="code-line">Amazonの商品ページ、canonicalなリンクを取得するだけでは、商品名もURLに含まれる。本当に必要なデータは<code>/dp/</code>以降だけで良いので正規表現で商品名を取っ払うようにしている。</p>
<p data-line="54" class="code-line">関数内をあえて2行にしてるのは、ついでに機能載せたいからですね。</p>
<h4 id="%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4" data-line="56" class="code-line"><a class="header-anchor-link" href="#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4" aria-hidden="true"></a> ついでにつぶやくやつ</h4>
<p data-line="57" class="code-line">こういうのとか。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="59"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel="canonical"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">amazon<span class="token char-set class-name">.</span>co<span class="token char-set class-name">.</span>jp<span class="token escape">\/</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token escape">\/</span>dp</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'amazon.co.jp/dp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> r<span class="token punctuation">;</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">open</span><span class="token punctuation">(</span><span class="token string">"https://twitter.com/intent/tweet?text="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">"見てる / "</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&amp;url="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97" data-line="63" class="code-line"><a class="header-anchor-link" href="#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97" aria-hidden="true"></a> ついでにMarkdown取得</h4>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="65"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel="canonical"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">amazon<span class="token char-set class-name">.</span>co<span class="token char-set class-name">.</span>jp<span class="token escape">\/</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token escape">\/</span>dp</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'amazon.co.jp/dp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> r<span class="token punctuation">;</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">prompt</span><span class="token punctuation">(</span><span class="token string">"Link Created! - Markdown"</span><span class="token punctuation">,</span> <span class="token string">'['</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">+</span> <span class="token string">']('</span> <span class="token operator">+</span> r <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97" data-line="69" class="code-line"><a class="header-anchor-link" href="#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97" aria-hidden="true"></a> ついでにHTML Anchor取得</h3>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="71"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel="canonical"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">amazon<span class="token char-set class-name">.</span>co<span class="token char-set class-name">.</span>jp<span class="token escape">\/</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token escape">\/</span>dp</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'amazon.co.jp/dp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> r<span class="token punctuation">;</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">prompt</span><span class="token punctuation">(</span><span class="token string">"Link Created! - html"</span><span class="token punctuation">,</span> <span class="token string">'&lt;a href="'</span> <span class="token operator">+</span> r <span class="token operator">+</span> <span class="token string">'" target="_blank"&gt;'</span> <span class="token operator">+</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">+</span> <span class="token string">"&lt;/a&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9" data-line="75" class="code-line"><a class="header-anchor-link" href="#%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9" aria-hidden="true"></a> 余談だけど</h3>
<p data-line="77" class="code-line"><code>document.querySelector('link[rel="canonical"]')</code>でcanonicalなリンクを取得できるの覚えておくとかなり便利。</p>
<p data-line="79" class="code-line"><code>querySelector</code>で書く以前は、以下のようなコード書いてたけど、<code>querySelector</code>で行けると知ってから、ブックマークレットの大幅なダイエットに成功しました。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="82"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"link"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token property-access">rel</span> <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">.</span><span class="token property-access">rel</span><span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"canonical"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> el<span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p data-line="96" class="code-line">Chromeの場合だけなのか未検証だけど、<code>document.getElementsByTagName</code>で返ってくるのがなぜか<code>HTMLCollection</code>なので、<code>[].forEach.call</code>なんてのを使うトリッキーさ。(わかってればそこまでトリッキーではないかも)</p>
<h3 id="amazon%E4%BB%A5%E5%A4%96" data-line="98" class="code-line"><a class="header-anchor-link" href="#amazon%E4%BB%A5%E5%A4%96" aria-hidden="true"></a> Amazon以外</h3>
<p data-line="100" class="code-line">単純にcanonicalなURLに置き換えるようにするだけ。見ているページが読み込みし直されてしまうので、一応注意はした方がいい。</p>
<div class="code-block-container"><pre class="language-js"><code class="language-js code-line" data-line="102"><span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">var</span> r <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'link[rel="canonical"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">href</span><span class="token punctuation">;</span> <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p data-line="106" class="code-line"><code>document.querySelector('link[rel="canonical"]')</code>が取得できない場合、ページ遷移は発生しない。</p>
<p data-line="108" class="code-line">こちらのブックマークレットは使用頻度が低いため、つぶやきたい場合やMarkdown取得したい場合などは個別のブックマークレットと併用している。</p>
<h3 id="%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B" data-line="110" class="code-line"><a class="header-anchor-link" href="#%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B" aria-hidden="true"></a> 見てるページをPDF化する</h3>
<p data-line="112" class="code-line">これもあまり使用頻度が高くないため、以下のサイトで公開されているブックマークレットをそのまま使用して、PDFに印刷する。という手順を行っている。</p>
<ul data-line="114" class="code-line">
<li data-line="114" class="code-line"><a href="https://css-tricks.github.io/The-Printliminator/" target="_blank" rel="nofollow noopener noreferrer">The Printliminator Demo</a></li>
</ul>
<p data-line="116" class="code-line">使い方などは割愛。</p>
<h2 id="javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89" data-line="118" class="code-line"><a class="header-anchor-link" href="#javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89" aria-hidden="true"></a> JavaScript書けるなら</h2>
<p data-line="120" class="code-line">ブックマークレットで遊ぶと楽しい。</p>
<p data-line="122" class="code-line">以上</p>
</div></div></article></div></main></div><footer class="footer"><div class="container"><a class="hover_underline" href="/posts/about">About this web site.</a><small>©2022- <a href="https://nagatani.me/">Nagatani</a></small></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"いつも使ってるブックマークレット(過去記事の再掲)","date":"2022-06-09T22:13:02+09:00","slug":"talk-about-bookmarklet","content":"\u003ch2 id=\"%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" data-line=\"1\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" aria-hidden=\"true\"\u003e\u003c/a\u003e 見ているサイトを共有するためのブックマークレット\u003c/h2\u003e\n\u003cp data-line=\"3\" class=\"code-line\"\u003e\u003cem\u003e\u003cstrong\u003eChromeでしか動作確認してません。\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cp data-line=\"5\" class=\"code-line\"\u003eブックマークレットでできることはできる限りやるようにすると、余計なChrome拡張機能を追加しなくて済むのでおすすめ。\u003cbr /\u003e\nブックマークレットの作り方をわざわざ説明するのめんどいので使いたいひとは調べよう。\u003c/p\u003e\n\u003ch3 id=\"%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" data-line=\"8\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" aria-hidden=\"true\"\u003e\u003c/a\u003e 今見ているWebサイトをTwitterで共有するブックマークレット\u003c/h3\u003e\n\u003cp data-line=\"10\" class=\"code-line\"\u003eTwitterへのWebページ共有はコレを使ってる。「見てる」ってのは、「見てる」のであって読んではいないんですよ。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"12\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"https://twitter.com/intent/tweet?text=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"見てる / \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026amp;url=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"16\" class=\"code-line\"\u003e1行で書いたやつを整形したコード:\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"18\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"https://twitter.com/intent/tweet?text=\"\u003c/span\u003e\n    \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"見てる / \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026amp;url=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" data-line=\"29\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e Markdownで見てるサイトのURLを取得する\u003c/h3\u003e\n\u003cp data-line=\"30\" class=\"code-line\"\u003e資料作成はほぼMarkdownで書いてるので、これは必須。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"32\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprompt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Link Created! - Markdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'['\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e']('\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elocation\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e')'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)\" data-line=\"36\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)\" aria-hidden=\"true\"\u003e\u003c/a\u003e HTMLのAタグで見てるサイトのURLを取得する(target=\"_blank\"付き)\u003c/h3\u003e\n\u003cp data-line=\"37\" class=\"code-line\"\u003e資料書いてる時にどうしても\u003ccode\u003etarget=\"\\_blank\"\u003c/code\u003eを使いたい時に使う。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"39\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprompt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Link Created! - html\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026lt;a href=\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elocation\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\" target=\"_blank\"\u0026gt;'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026lt;/a\u0026gt;\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4\" data-line=\"43\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4\" aria-hidden=\"true\"\u003e\u003c/a\u003e Amazonの商品ページのURLをきれいにするやつ\u003c/h3\u003e\n\u003cp data-line=\"45\" class=\"code-line\"\u003eAmazonの商品ページのURL、遷移元なんかの余計なクエリ文字列がくっついてくることがほとんどで、それを共有するのは気が引ける。\u003cbr /\u003e\nそんな時はこれ。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"48\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'link[rel=\"canonical\"]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003eamazon\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003eco\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003ejp\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003e\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e*\u003c/span\u003e\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003edp\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'amazon.co.jp/dp'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e r\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"52\" class=\"code-line\"\u003eAmazonの商品ページ、canonicalなリンクを取得するだけでは、商品名もURLに含まれる。本当に必要なデータは\u003ccode\u003e/dp/\u003c/code\u003e以降だけで良いので正規表現で商品名を取っ払うようにしている。\u003c/p\u003e\n\u003cp data-line=\"54\" class=\"code-line\"\u003e関数内をあえて2行にしてるのは、ついでに機能載せたいからですね。\u003c/p\u003e\n\u003ch4 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4\" data-line=\"56\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4\" aria-hidden=\"true\"\u003e\u003c/a\u003e ついでにつぶやくやつ\u003c/h4\u003e\n\u003cp data-line=\"57\" class=\"code-line\"\u003eこういうのとか。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"59\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'link[rel=\"canonical\"]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003eamazon\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003eco\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003ejp\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003e\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e*\u003c/span\u003e\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003edp\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'amazon.co.jp/dp'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e r\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"https://twitter.com/intent/tweet?text=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"見てる / \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026amp;url=\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97\" data-line=\"63\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97\" aria-hidden=\"true\"\u003e\u003c/a\u003e ついでにMarkdown取得\u003c/h4\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"65\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'link[rel=\"canonical\"]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003eamazon\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003eco\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003ejp\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003e\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e*\u003c/span\u003e\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003edp\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'amazon.co.jp/dp'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e r\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprompt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Link Created! - Markdown\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'['\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e']('\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e')'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97\" data-line=\"69\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97\" aria-hidden=\"true\"\u003e\u003c/a\u003e ついでにHTML Anchor取得\u003c/h3\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"71\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'link[rel=\"canonical\"]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003eamazon\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003eco\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003ejp\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003e\u003cspan class=\"token char-set class-name\"\u003e.\u003c/span\u003e\u003cspan class=\"token quantifier number\"\u003e*\u003c/span\u003e\u003cspan class=\"token escape\"\u003e\\/\u003c/span\u003edp\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'amazon.co.jp/dp'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e r\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003ewindow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eprompt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Link Created! - html\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026lt;a href=\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\" target=\"_blank\"\u0026gt;'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003etitle\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\u0026lt;/a\u0026gt;\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9\" data-line=\"75\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9\" aria-hidden=\"true\"\u003e\u003c/a\u003e 余談だけど\u003c/h3\u003e\n\u003cp data-line=\"77\" class=\"code-line\"\u003e\u003ccode\u003edocument.querySelector('link[rel=\"canonical\"]')\u003c/code\u003eでcanonicalなリンクを取得できるの覚えておくとかなり便利。\u003c/p\u003e\n\u003cp data-line=\"79\" class=\"code-line\"\u003e\u003ccode\u003equerySelector\u003c/code\u003eで書く以前は、以下のようなコード書いてたけど、\u003ccode\u003equerySelector\u003c/code\u003eで行けると知ってから、ブックマークレットの大幅なダイエットに成功しました。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"82\"\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetElementsByTagName\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"link\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003erel\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003erel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoLowerCase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"canonical\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"96\" class=\"code-line\"\u003eChromeの場合だけなのか未検証だけど、\u003ccode\u003edocument.getElementsByTagName\u003c/code\u003eで返ってくるのがなぜか\u003ccode\u003eHTMLCollection\u003c/code\u003eなので、\u003ccode\u003e[].forEach.call\u003c/code\u003eなんてのを使うトリッキーさ。(わかってればそこまでトリッキーではないかも)\u003c/p\u003e\n\u003ch3 id=\"amazon%E4%BB%A5%E5%A4%96\" data-line=\"98\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#amazon%E4%BB%A5%E5%A4%96\" aria-hidden=\"true\"\u003e\u003c/a\u003e Amazon以外\u003c/h3\u003e\n\u003cp data-line=\"100\" class=\"code-line\"\u003e単純にcanonicalなURLに置き換えるようにするだけ。見ているページが読み込みし直されてしまうので、一応注意はした方がいい。\u003c/p\u003e\n\u003cdiv class=\"code-block-container\"\u003e\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js code-line\" data-line=\"102\"\u003e\u003cspan class=\"token literal-property property\"\u003ejavascript\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'link[rel=\"canonical\"]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003elocation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ehref\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e r\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp data-line=\"106\" class=\"code-line\"\u003e\u003ccode\u003edocument.querySelector('link[rel=\"canonical\"]')\u003c/code\u003eが取得できない場合、ページ遷移は発生しない。\u003c/p\u003e\n\u003cp data-line=\"108\" class=\"code-line\"\u003eこちらのブックマークレットは使用頻度が低いため、つぶやきたい場合やMarkdown取得したい場合などは個別のブックマークレットと併用している。\u003c/p\u003e\n\u003ch3 id=\"%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B\" data-line=\"110\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B\" aria-hidden=\"true\"\u003e\u003c/a\u003e 見てるページをPDF化する\u003c/h3\u003e\n\u003cp data-line=\"112\" class=\"code-line\"\u003eこれもあまり使用頻度が高くないため、以下のサイトで公開されているブックマークレットをそのまま使用して、PDFに印刷する。という手順を行っている。\u003c/p\u003e\n\u003cul data-line=\"114\" class=\"code-line\"\u003e\n\u003cli data-line=\"114\" class=\"code-line\"\u003e\u003ca href=\"https://css-tricks.github.io/The-Printliminator/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eThe Printliminator Demo\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp data-line=\"116\" class=\"code-line\"\u003e使い方などは割愛。\u003c/p\u003e\n\u003ch2 id=\"javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89\" data-line=\"118\" class=\"code-line\"\u003e\u003ca class=\"header-anchor-link\" href=\"#javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89\" aria-hidden=\"true\"\u003e\u003c/a\u003e JavaScript書けるなら\u003c/h2\u003e\n\u003cp data-line=\"120\" class=\"code-line\"\u003eブックマークレットで遊ぶと楽しい。\u003c/p\u003e\n\u003cp data-line=\"122\" class=\"code-line\"\u003e以上\u003c/p\u003e\n","excerpt":"以前のサイトで書いていたChromeのブックマークレットの記事を再掲します"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"talk-about-bookmarklet"},"buildId":"KkecMBZn0eRxO-9hSKnjv","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>