---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

// 記事を取得し、日付順にソートして最新5件を抽出
const posts = (
	await getCollection("blog", ({ data }) => {
		return import.meta.env.PROD ? data.draft !== true : true;
	})
)
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 5);
---

<!doctype html>
<html lang="ja">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<section>
				<h1>Hi👋</h1>
				<h2>このサイトについて</h2>
				<p>
					ここは適当な文章をだらだらと書き残したり、技術的なことの覚え書きを残す個人的なメモ帳です。<br
					/>
					サイトコンテンツは以下の GitHub にて管理されております。<br />
					記事に間違いがある場合は Issue を、サイトにバグがある場合は、Pull Request
					または Issue を立ててくれると見ます。<br />
					<br />
					<a
						href="https://github.com/Nagatani/nagatani.github.io"
						target="_blank"
						rel="nofollow noopener noreferrer"
						>Nagatani/nagatani.github.io: Memorandum</a
					>
				</p>
				<p>
					メールでのお問い合わせは、
					<a href="mailto:hey@nagatani.me">hey@nagatani.me</a>
					まで。
				</p>
			</section>

			<section>
				<h2>新しいメモ</h2>
				<ul class="posts-list">
					{
						posts.map((post) => (
							<li>
								{post.data.heroImage && (
									<Image
										src={post.data.heroImage}
										alt=""
										width={720}
										height={360}
										class="thumbnail"
									/>
								)}
								<a href={`/memo/${post.id}/`}>{post.data.title}</a>
								<span class="date">
									<a href={`/memo/${post.id}/`}>
										<FormattedDate date={post.data.pubDate} />
									</a>
								</span>
							</li>
						))
					}
				</ul>

				<div class="all-posts-link">
					<a href="/memo">全部見る &rarr;</a>
				</div>
			</section>

			<section>
				<h2>Nagataniについて</h2>
				<dl class="qa-list">
					<dt>何してる人？</dt>
					<dd>
						フリーランスプログラマ、非常勤講師(工学系大学の情報科)、法人経営<br
						/>
						などなど
					</dd>
					<dt>趣味は？</dt>
					<dd>
						DIY、ねこ、プログラミング、読書、コーヒー、カメラ、料理<br />
						などなど
					</dd>
				</dl>
				<p>
					より詳しく知りたい方は個人サイトへどうぞ。
					<a
						href="https://nagatani.me/"
						target="_blank"
						rel="nofollow noopener noreferrer">https://nagatani.me/</a
					>
				</p>
			</section>
		</main>
		<Footer />
	</body>
</html>
