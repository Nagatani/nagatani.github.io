{"pageProps":{"post":{"title":"いつも使ってるブックマークレット(過去記事の再掲)","date":"2022-06-09T22:13:02+09:00","slug":"talk-about-bookmarklet","content":"<h2 id=\"%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" data-line=\"1\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" aria-hidden=\"true\"></a> 見ているサイトを共有するためのブックマークレット</h2>\n<p data-line=\"3\" class=\"code-line\"><em><strong>Chromeでしか動作確認してません。</strong></em></p>\n<p data-line=\"5\" class=\"code-line\">ブックマークレットでできることはできる限りやるようにすると、余計なChrome拡張機能を追加しなくて済むのでおすすめ。<br />\nブックマークレットの作り方をわざわざ説明するのめんどいので使いたいひとは調べよう。</p>\n<h3 id=\"%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" data-line=\"8\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E4%BB%8A%E8%A6%8B%E3%81%A6%E3%81%84%E3%82%8Bweb%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92twitter%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B%E3%83%96%E3%83%83%E3%82%AF%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88\" aria-hidden=\"true\"></a> 今見ているWebサイトをTwitterで共有するブックマークレット</h3>\n<p data-line=\"10\" class=\"code-line\">TwitterへのWebページ共有はコレを使ってる。「見てる」ってのは、「見てる」のであって読んではいないんですよ。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"12\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://twitter.com/intent/tweet?text=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"見てる / \"</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;url=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><p data-line=\"16\" class=\"code-line\">1行で書いたやつを整形したコード:</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"18\"><span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">open</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"https://twitter.com/intent/tweet?text=\"</span>\n    <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"見てる / \"</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;url=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h3 id=\"markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" data-line=\"29\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#markdown%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-hidden=\"true\"></a> Markdownで見てるサイトのURLを取得する</h3>\n<p data-line=\"30\" class=\"code-line\">資料作成はほぼMarkdownで書いてるので、これは必須。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"32\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Link Created! - Markdown\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span> <span class=\"token operator\">+</span> <span class=\"token string\">']('</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span> <span class=\"token operator\">+</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h3 id=\"html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)\" data-line=\"36\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#html%E3%81%AEa%E3%82%BF%E3%82%B0%E3%81%A7%E8%A6%8B%E3%81%A6%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AEurl%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B(target%3D%22_blank%22%E4%BB%98%E3%81%8D)\" aria-hidden=\"true\"></a> HTMLのAタグで見てるサイトのURLを取得する(target=\"_blank\"付き)</h3>\n<p data-line=\"37\" class=\"code-line\">資料書いてる時にどうしても<code>target=\"\\_blank\"</code>を使いたい時に使う。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"39\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Link Created! - html\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;a href=\"'</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\" target=\"_blank\"&gt;'</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;/a&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h3 id=\"amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4\" data-line=\"43\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#amazon%E3%81%AE%E5%95%86%E5%93%81%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AEurl%E3%82%92%E3%81%8D%E3%82%8C%E3%81%84%E3%81%AB%E3%81%99%E3%82%8B%E3%82%84%E3%81%A4\" aria-hidden=\"true\"></a> Amazonの商品ページのURLをきれいにするやつ</h3>\n<p data-line=\"45\" class=\"code-line\">Amazonの商品ページのURL、遷移元なんかの余計なクエリ文字列がくっついてくることがほとんどで、それを共有するのは気が引ける。<br />\nそんな時はこれ。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"48\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link[rel=\"canonical\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">amazon<span class=\"token char-set class-name\">.</span>co<span class=\"token char-set class-name\">.</span>jp<span class=\"token escape\">\\/</span><span class=\"token char-set class-name\">.</span><span class=\"token quantifier number\">*</span><span class=\"token escape\">\\/</span>dp</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'amazon.co.jp/dp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span> <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><p data-line=\"52\" class=\"code-line\">Amazonの商品ページ、canonicalなリンクを取得するだけでは、商品名もURLに含まれる。本当に必要なデータは<code>/dp/</code>以降だけで良いので正規表現で商品名を取っ払うようにしている。</p>\n<p data-line=\"54\" class=\"code-line\">関数内をあえて2行にしてるのは、ついでに機能載せたいからですね。</p>\n<h4 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4\" data-line=\"56\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB%E3%81%A4%E3%81%B6%E3%82%84%E3%81%8F%E3%82%84%E3%81%A4\" aria-hidden=\"true\"></a> ついでにつぶやくやつ</h4>\n<p data-line=\"57\" class=\"code-line\">こういうのとか。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"59\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link[rel=\"canonical\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">amazon<span class=\"token char-set class-name\">.</span>co<span class=\"token char-set class-name\">.</span>jp<span class=\"token escape\">\\/</span><span class=\"token char-set class-name\">.</span><span class=\"token quantifier number\">*</span><span class=\"token escape\">\\/</span>dp</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'amazon.co.jp/dp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span> <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://twitter.com/intent/tweet?text=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"見てる / \"</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&amp;url=\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h4 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97\" data-line=\"63\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABmarkdown%E5%8F%96%E5%BE%97\" aria-hidden=\"true\"></a> ついでにMarkdown取得</h4>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"65\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link[rel=\"canonical\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">amazon<span class=\"token char-set class-name\">.</span>co<span class=\"token char-set class-name\">.</span>jp<span class=\"token escape\">\\/</span><span class=\"token char-set class-name\">.</span><span class=\"token quantifier number\">*</span><span class=\"token escape\">\\/</span>dp</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'amazon.co.jp/dp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span> <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Link Created! - Markdown\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'['</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span> <span class=\"token operator\">+</span> <span class=\"token string\">']('</span> <span class=\"token operator\">+</span> r <span class=\"token operator\">+</span> <span class=\"token string\">')'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h3 id=\"%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97\" data-line=\"69\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E3%81%A4%E3%81%84%E3%81%A7%E3%81%ABhtml-anchor%E5%8F%96%E5%BE%97\" aria-hidden=\"true\"></a> ついでにHTML Anchor取得</h3>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"71\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link[rel=\"canonical\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">amazon<span class=\"token char-set class-name\">.</span>co<span class=\"token char-set class-name\">.</span>jp<span class=\"token escape\">\\/</span><span class=\"token char-set class-name\">.</span><span class=\"token quantifier number\">*</span><span class=\"token escape\">\\/</span>dp</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'amazon.co.jp/dp'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span> <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Link Created! - html\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;a href=\"'</span> <span class=\"token operator\">+</span> r <span class=\"token operator\">+</span> <span class=\"token string\">'\" target=\"_blank\"&gt;'</span> <span class=\"token operator\">+</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"&lt;/a&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><h3 id=\"%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9\" data-line=\"75\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E4%BD%99%E8%AB%87%E3%81%A0%E3%81%91%E3%81%A9\" aria-hidden=\"true\"></a> 余談だけど</h3>\n<p data-line=\"77\" class=\"code-line\"><code>document.querySelector('link[rel=\"canonical\"]')</code>でcanonicalなリンクを取得できるの覚えておくとかなり便利。</p>\n<p data-line=\"79\" class=\"code-line\"><code>querySelector</code>で書く以前は、以下のようなコード書いてたけど、<code>querySelector</code>で行けると知ってから、ブックマークレットの大幅なダイエットに成功しました。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"82\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">forEach</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>\n    <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"link\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">.</span><span class=\"token property-access\">rel</span> <span class=\"token operator\">&amp;&amp;</span> el<span class=\"token punctuation\">.</span><span class=\"token property-access\">rel</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"canonical\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> el<span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div><p data-line=\"96\" class=\"code-line\">Chromeの場合だけなのか未検証だけど、<code>document.getElementsByTagName</code>で返ってくるのがなぜか<code>HTMLCollection</code>なので、<code>[].forEach.call</code>なんてのを使うトリッキーさ。(わかってればそこまでトリッキーではないかも)</p>\n<h3 id=\"amazon%E4%BB%A5%E5%A4%96\" data-line=\"98\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#amazon%E4%BB%A5%E5%A4%96\" aria-hidden=\"true\"></a> Amazon以外</h3>\n<p data-line=\"100\" class=\"code-line\">単純にcanonicalなURLに置き換えるようにするだけ。見ているページが読み込みし直されてしまうので、一応注意はした方がいい。</p>\n<div class=\"code-block-container\"><pre class=\"language-js\"><code class=\"language-js code-line\" data-line=\"102\"><span class=\"token literal-property property\">javascript</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> r <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link[rel=\"canonical\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span><span class=\"token punctuation\">;</span> <span class=\"token dom variable\">location</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">href</span> <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><p data-line=\"106\" class=\"code-line\"><code>document.querySelector('link[rel=\"canonical\"]')</code>が取得できない場合、ページ遷移は発生しない。</p>\n<p data-line=\"108\" class=\"code-line\">こちらのブックマークレットは使用頻度が低いため、つぶやきたい場合やMarkdown取得したい場合などは個別のブックマークレットと併用している。</p>\n<h3 id=\"%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B\" data-line=\"110\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#%E8%A6%8B%E3%81%A6%E3%82%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92pdf%E5%8C%96%E3%81%99%E3%82%8B\" aria-hidden=\"true\"></a> 見てるページをPDF化する</h3>\n<p data-line=\"112\" class=\"code-line\">これもあまり使用頻度が高くないため、以下のサイトで公開されているブックマークレットをそのまま使用して、PDFに印刷する。という手順を行っている。</p>\n<ul data-line=\"114\" class=\"code-line\">\n<li data-line=\"114\" class=\"code-line\"><a href=\"https://css-tricks.github.io/The-Printliminator/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">The Printliminator Demo</a></li>\n</ul>\n<p data-line=\"116\" class=\"code-line\">使い方などは割愛。</p>\n<h2 id=\"javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89\" data-line=\"118\" class=\"code-line\"><a class=\"header-anchor-link\" href=\"#javascript%E6%9B%B8%E3%81%91%E3%82%8B%E3%81%AA%E3%82%89\" aria-hidden=\"true\"></a> JavaScript書けるなら</h2>\n<p data-line=\"120\" class=\"code-line\">ブックマークレットで遊ぶと楽しい。</p>\n<p data-line=\"122\" class=\"code-line\">以上</p>\n","excerpt":"以前のサイトで書いていたChromeのブックマークレットの記事を再掲します"}},"__N_SSG":true}